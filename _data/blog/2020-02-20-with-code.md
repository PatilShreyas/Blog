---
template: BlogPost
path: /with-code
date: 2020-02-20T15:08:12.174Z
title: Code with Syntax Highlighting with PrismJS
thumbnail: /assets/image-2.jpg
---
### Code Highlighting

Hey hi there... Testing \`inline\` code too..

```kotlin
package dev.shreyaspatil.firebase.coroutines.utils

import com.google.firebase.firestore.CollectionReference
import kotlinx.coroutines.ExperimentalCoroutinesApi
import kotlinx.coroutines.cancel
import kotlinx.coroutines.channels.awaitClose
import kotlinx.coroutines.flow.callbackFlow

@ExperimentalCoroutinesApi
fun CollectionReference.getSnapshotFlow() = callbackFlow {
    
    // Register listener
    val listener = addSnapshotListener { snapshot, exception ->
        
        offer(snapshot)

        // If exception occurs, cancel this scope with exception message.
        exception?.let {
            cancel(it.message.toString())
        }
    }

    awaitClose {
        // This block is executed when producer channel is cancelled
        // This function resumes with a cancellation exception.
        // Dispose listener
        listener.remove()
        cancel() 
    }
}
```
